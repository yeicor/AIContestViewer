on: "push"

jobs:
  export:
    runs-on: "ubuntu-latest"
    steps:
    - uses: "actions/checkout@v4"
    
    - uses: "actions/setup-java@v3"
      with:
        java-version: '17'
        distribution: 'temurin'
    - uses: "android-actions/setup-android@v3"
    
    - uses: "firebelley/godot-export@v6.0.0"
      id: "export"
      with: # TODO: Auto-update godot
        presets_to_export: "Linux/X11,Windows Desktop,Web"
        godot_executable_download_url: "https://github.com/godotengine/godot/releases/download/4.4.1-stable/Godot_v4.4.1-stable_linux.x86_64.zip"
        godot_export_templates_download_url: "https://github.com/godotengine/godot/releases/download/4.4.1-stable/Godot_v4.4.1-stable_export_templates.tpz"
        relative_project_path: "./"
        cache: true
        archive_output: true
    
    - uses: "firebelley/godot-export@v6.0.0"
      id: "export2"
      with: # TODO: Auto-update godot
        export_debug: true
        presets_to_export: "Android"
        godot_executable_download_url: "https://github.com/godotengine/godot/releases/download/4.4.1-stable/Godot_v4.4.1-stable_linux.x86_64.zip"
        godot_export_templates_download_url: "https://github.com/godotengine/godot/releases/download/4.4.1-stable/Godot_v4.4.1-stable_export_templates.tpz"
        relative_project_path: "./"
        cache: true
        archive_output: true
        
    - uses: "actions/upload-artifact@v4"
      with:
        path: |
          ${{ steps.export.outputs.archive_directory }}
          ${{ steps.export2.outputs.archive_directory }}
